;; â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
;; â•‘ GRAINCARD SPEC VALIDATOR (Ketos - inspired by Clojure Spec)                 â•‘
;; â•‘ Team: 06 (teamprecision06 - Virgo â™ / VI. The Lovers)                       â•‘
;; â•‘ Copyright Â© 3x39 | Author: kae3g (kj3x39, @risc.love)                        â•‘
;; â•‘ Grainbook Issue 1: Ember Harvest ğŸƒ (System Magazine)                       â•‘
;; â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
;;
;; Glow G2: Let me teach you what this validator does and why it matters.
;;
;; THE PROBLEM:
;; You want 1,235,520 grains to have EXACTLY the same format. Every grain
;; must be 80Ã—110 monospace. Every grain must have the > next button in the
;; exact right place. How do you enforce this across all grains?
;;
;; THE SOLUTION: GRAINCARD SPEC
;; A Ketos validator that checks EVERY formatting rule. If a grain doesn't
;; pass validation, it can't be published. Precision with love. ğŸ’•
;;
;; WHY KETOS?
;; - Runs on Redox OS (our future platform)
;; - Fast (Rust underneath)
;; - Lisp syntax (readable, composable)
;; - No GC issues (owned by Rust)
;;
;; DOES THIS MAKE SENSE?
;; This validator is like a quality control inspector. Every grain passes
;; through it. Only perfect grains get published. Team 14 precision.

;; â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
;; â•‘ DIMENSIONS (The Sacred Numbers)                                             â•‘
;; â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

(define GRAIN-WIDTH 80)
  ;; Glow G2: Why 80? Classic terminal width. Unix tradition. Works everywhere.

(define GRAIN-CONTENT-WIDTH 78)
  ;; Glow G2: 78 inside the box (80 - 2 for the â”‚ borders on each side)

(define GRAIN-HEIGHT 110)
  ;; Glow G2: Why 110? Fits portrait mobile with scroll. Landscape tablet
  ;; in MOVIE MODE. Not too short (truncated), not too long (scrolling forever).

;; â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
;; â•‘ BOTTOM FOOTER SPEC (The Critical Rules!)                                    â•‘
;; â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
;;
;; Glow G2: The bottom of every grain follows an EXACT pattern:
;;
;; Line 110 (last):       BLANK (empty after closing ```)
;; Line 109 (2nd last):   "now == next + 1 ğŸŒ¾"
;; Line 108 (3rd last):   "Next: [xbdghk](...) â†’"
;; Line 107 (4th last):   BLANK (spacing)
;; Line 106 (5th last):   "Grain: xbdghj (N of 1,235,520)              >"
;; Line 105 (6th last):   "Grainbook Issue 1: Ember Harvest ğŸƒ"
;; Line 104 (7th last):   "â”œâ”€â”€â”€â”€...â”€â”€â”€â”€â”¤" (separator)
;;
;; THE MOST IMPORTANT RULE:
;; Line 106 must have the 6-char grain code + > next button
;; The > must be in the 3rd position from the right edge
;; Format: â”‚ Grain: xbdghj (1 of 1,235,520)                                             > â”‚
;;                ^^^^^^                                                              ^
;;                6 chars                                                        next button
;;
;; Why? The > becomes a clickable next button on the live site!

(define (spec-last-line-blank? lines)
  "Glow G2: Line 110 must be blank. This gives breathing room after the grain.
   Like a pause at the end of a chapter. Does this make sense?"
  
  (let ((last-line (nth 109 lines)))  ;; 0-indexed (line 110 = index 109)
    (or (nil? last-line) 
        (= "" (string-trim last-line)))))

(define (spec-now-equals-next? lines)
  "Glow G2: Line 109 must be 'now == next + 1 ğŸŒ¾'. Our signature.
   This line teaches the philosophy: the present moment creates the next."
  
  (let ((line (nth 108 lines)))  ;; Line 109 = index 108
    (if line
        (string-contains? line "now == next + 1 ğŸŒ¾")
        false)))

(define (spec-has-next-link? lines)
  "Glow G2: Line 108 must have 'Next: [code](file.md) â†’'.
   This is the GitHub markdown link for browsing the repo."
  
  (let ((line (nth 107 lines)))  ;; Line 108 = index 107
    (if line
        (and (string-contains? line "Next:")
             (string-contains? line "â†’"))
        false)))

(define (spec-blank-before-next? lines)
  "Glow G2: Line 107 must be blank. Spacing before the 'Next' link.
   Visual breathing room. Makes the footer readable."
  
  (let ((line (nth 106 lines)))  ;; Line 107 = index 106
    (or (nil? line)
        (= "" (string-trim line)))))

(define (spec-grain-code-with-next-button? lines)
  "Glow G2: Line 106 is THE MOST CRITICAL LINE.
   
   Must have:
   1. The word 'Grain:'
   2. Exactly 6 characters (the grain code, like xbdghj)
   3. The count '(N of 1,235,520)'
   4. The > next button in the 3rd position from right
   
   Format: â”‚ Grain: xbdghj (1 of 1,235,520)                                             > â”‚
           ^       ^^^^^^                                                              ^
           border  6 chars                                                      next button
           
   Why the >? It becomes a clickable button on the live site. Svelte converts
   it to a link. On GitHub, it's a visual indicator. Both interfaces work!"
  
  (let ((line (nth 105 lines)))  ;; Line 106 = index 105
    (if line
        (and 
         ;; Must contain "Grain:"
         (string-contains? line "Grain:")
         
         ;; Must have 6-char grain code (validates it's from grainorder alphabet)
         (let ((code-match (regexp-match "Grain: ([xbdghjklmnsvz]{6})" line)))
           (if code-match
               (= 6 (length (nth 1 code-match)))
               false))
         
         ;; Must have > in 3rd position from right (before space and â”‚)
         ;; Example: "...520)                                             > â”‚"
         ;;                                                                ^
         ;;                                                    3rd from right
         (let ((trimmed (string-trim-right line)))
           (if (>= (length trimmed) 3)
               (= (string-ref trimmed (- (length trimmed) 3)) #\>)
               false)))
        false)))

(define (spec-has-grainbook-issue? lines)
  "Glow G2: Line 105 must say 'Grainbook Issue 1: Ember Harvest ğŸƒ'.
   This tells readers which issue they're reading. Like a magazine cover."
  
  (let ((line (nth 104 lines)))  ;; Line 105 = index 104
    (if line
        (and (string-contains? line "Grainbook Issue")
             (string-contains? line "Ember Harvest"))
        false)))

(define (spec-has-separator? lines)
  "Glow G2: Line 104 must be the separator: â”œâ”€â”€â”€â”€...â”€â”€â”€â”€â”¤
   This separates the content from the footer. Visual clarity."
  
  (let ((line (nth 103 lines)))  ;; Line 104 = index 103
    (if line
        (string-contains? line "â”œâ”€â”€â”€â”€â”€â”€")
        false)))

;; â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
;; â•‘ WIDTH VALIDATION                                                             â•‘
;; â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

(define (spec-line-width-valid? line)
  "Glow G2: Each line must be â‰¤ 80 chars. Why? Classic terminal width.
   Fits on any screen. Respects the Unix tradition of 80-column displays."
  
  (<= (length line) GRAIN-WIDTH))

(define (spec-all-lines-width-valid? lines)
  "Glow G2: Check EVERY line. If even one line is too wide, the grain
   won't display correctly on narrow terminals or mobile portrait mode."
  
  (every? spec-line-width-valid? lines))

;; â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
;; â•‘ HEIGHT VALIDATION                                                            â•‘
;; â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

(define (spec-height-valid? lines)
  "Glow G2: Must be EXACTLY 110 lines. Not 109, not 111. Exactly 110.
   
   Why? This creates consistency. Every grain is the same height. When you
   scroll on mobile, you know how far you are. Predictability = usability."
  
  (= GRAIN-HEIGHT (length lines)))

;; â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
;; â•‘ BOX STRUCTURE VALIDATION                                                     â•‘
;; â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

(define (spec-has-top-border? lines)
  "Glow G2: Every grain must have a top border: â”Œâ”€â”€â”€â”€â”€â”€â”€...â”€â”€â”€â”€â”€â”€â”€â”
   This frames the content. Makes it look like a card, a box, a container."
  
  (some (lambda (line) (string-contains? line "â”Œâ”€â”€â”€â”€â”€â”€")) lines))

(define (spec-has-bottom-border? lines)
  "Glow G2: Every grain must have a bottom border: â””â”€â”€â”€â”€â”€â”€â”€...â”€â”€â”€â”€â”€â”€â”€â”˜
   This closes the box. Completion. The grain is contained."
  
  (some (lambda (line) (string-contains? line "â””â”€â”€â”€â”€â”€â”€")) lines))

;; â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
;; â•‘ COMPLETE VALIDATION (All Specs Together)                                    â•‘
;; â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

(define (validate-graincard content)
  "Glow G2: This is the main validation function. It checks EVERYTHING.
   
   Returns a map with:
     :valid - true/false
     :errors - list of what's wrong (empty if valid)
   
   Use this before publishing any grain. If it passes, you're good to go.
   If it fails, fix the errors and try again. Does this make sense?"
  
  (let ((lines (string-split content "\n"))
        (errors '()))
    
    ;; Check height (EXACTLY 110 lines)
    (unless (spec-height-valid? lines)
      (set! errors (cons (format "âŒ Height must be exactly ~a lines (got ~a)" 
                                 GRAIN-HEIGHT 
                                 (length lines))
                        errors)))
    
    ;; Check width (all lines â‰¤ 80 chars)
    (unless (spec-all-lines-width-valid? lines)
      (set! errors (cons "âŒ Some lines exceed 80 characters (check with ruler!)" 
                        errors)))
    
    ;; Check box borders
    (unless (spec-has-top-border? lines)
      (set! errors (cons "âŒ Missing top border (â”Œâ”€â”€â”€â”€â”€â”€â”€...)" errors)))
    
    (unless (spec-has-bottom-border? lines)
      (set! errors (cons "âŒ Missing bottom border (â””â”€â”€â”€â”€â”€â”€â”€...)" errors)))
    
    (unless (spec-has-separator? lines)
      (set! errors (cons "âŒ Missing footer separator (â”œâ”€â”€â”€â”€â”€â”€â”€...)" errors)))
    
    ;; Check bottom footer structure (THE CRITICAL RULES!)
    (unless (spec-last-line-blank? lines)
      (set! errors (cons "âŒ Line 110 (last) must be blank" errors)))
    
    (unless (spec-now-equals-next? lines)
      (set! errors (cons "âŒ Line 109 must be 'now == next + 1 ğŸŒ¾'" errors)))
    
    (unless (spec-has-next-link? lines)
      (set! errors (cons "âŒ Line 108 must have 'Next: [code](...) â†’'" errors)))
    
    (unless (spec-blank-before-next? lines)
      (set! errors (cons "âŒ Line 107 must be blank (spacing)" errors)))
    
    (unless (spec-grain-code-with-next-button? lines)
      (set! errors (cons "âŒ Line 106 must have 6-char code + > button (3rd from right)" 
                        errors)))
    
    (unless (spec-has-grainbook-issue? lines)
      (set! errors (cons "âŒ Line 105 must have 'Grainbook Issue 1: Ember Harvest ğŸƒ'" 
                        errors)))
    
    ;; Return validation result
    {:valid (empty? errors)
     :errors (reverse errors)
     :lines-checked (length lines)
     :grain-code (extract-grain-code lines)}))

;; â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
;; â•‘ GRAIN CODE EXTRACTION                                                        â•‘
;; â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

(define (extract-grain-code lines)
  "Glow G2: Extract the 6-char grain code from line 106.
   
   This is useful for reporting. When validation fails, we want to tell
   you WHICH grain failed. The grain code identifies it."
  
  (let ((line (nth 105 lines)))  ;; Line 106 = index 105
    (if line
        (let ((match (regexp-match "Grain: ([xbdghjklmnsvz]{6})" line)))
          (if match
              (nth 1 match)
              "unknown"))
        "unknown")))

;; â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
;; â•‘ PRETTY PRINTING (Human-Friendly Output)                                     â•‘
;; â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

(define (print-validation-result result)
  "Glow G2: Make the validation output beautiful and helpful.
   
   If valid: Celebrate! âœ…
   If invalid: Show exactly what's wrong and how to fix it."
  
  (println "")
  (println "â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”")
  (println "â”‚ GRAINCARD SPEC VALIDATOR                                                     â”‚")
  (println "â”‚ Team 14 (teamdescend14) - Precision                                          â”‚")
  (println "â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜")
  (println "")
  
  (if (:valid result)
      (do
        (println "âœ… VALID GRAIN!")
        (println "")
        (println (format "   Grain: ~a" (:grain-code result)))
        (println (format "   Lines: ~a (exactly 110 âœ“)" (:lines-checked result)))
        (println "   Width: All lines â‰¤ 80 chars âœ“")
        (println "   Footer: Perfect structure âœ“")
        (println "   > button: In correct position âœ“")
        (println "")
        (println "   This grain is ready for Grainbook Issue 1!")
        (println "   now == next + 1 ğŸŒ¾")
        (println ""))
      (do
        (println "âŒ INVALID GRAIN!")
        (println "")
        (println (format "   Grain: ~a" (:grain-code result)))
        (println (format "   Lines: ~a" (:lines-checked result)))
        (println "")
        (println "   Errors found:")
        (doseq [err (:errors result)]
          (println "   " err))
        (println "")
        (println "   ğŸ’• Glow G2 says: Don't worry! These are easy to fix.")
        (println "      The Lovers choose precision. Let's make it perfect together.")
        (println ""))))

;; â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
;; â•‘ CLI INTERFACE                                                                 â•‘
;; â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

(define (main args)
  "Glow G2: This is the command-line interface. Run it like this:
   
   $ ketos graincard-spec.ket xbdghj-grainbranch-readme-sync-babashka.md
   
   It will validate the grain and tell you if it passes all specs."
  
  (if (< (length args) 1)
      ;; No file provided - show usage
      (do
        (println "")
        (println "â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”")
        (println "â”‚ ğŸƒ Graincard Spec Validator (Ketos)                                         â”‚")
        (println "â”‚ Copyright Â© 3x39 | Author: kae3g | Team: 14 (teamdescend14)                 â”‚")
        (println "â”‚ Grainbook Issue 1: Ember Harvest ğŸƒ (System Magazine)                       â”‚")
        (println "â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜")
        (println "")
        (println "Glow G2: Let me teach you how to use this validator.")
        (println "")
        (println "USAGE:")
        (println "  ketos graincard-spec.ket <grain-file.md>")
        (println "")
        (println "EXAMPLE:")
        (println "  ketos graincard-spec.ket xbdghj-grainbranch-readme-sync-babashka.md")
        (println "")
        (println "VALIDATES:")
        (println "  âœ“ Exactly 110 lines")
        (println "  âœ“ Each line â‰¤ 80 chars")
        (println "  âœ“ Line 110: blank")
        (println "  âœ“ Line 109: 'now == next + 1 ğŸŒ¾'")
        (println "  âœ“ Line 108: 'Next: [code](...) â†’'")
        (println "  âœ“ Line 107: blank")
        (println "  âœ“ Line 106: 6-char code + > button")
        (println "  âœ“ Line 105: 'Grainbook Issue 1...'")
        (println "  âœ“ Has top/bottom borders and separator")
        (println "")
        (println "EXIT CODE:")
        (println "  0 if valid (success!)")
        (println "  1 if invalid (needs fixes)")
        (println "")
        (println "Does this make sense? This validator ensures every grain is perfect.")
        (println "")
        (println "now == next + 1 ğŸŒ¾")
        (println ""))
      
      ;; File provided - validate it!
      (let ((filepath (nth 0 args)))
        (println "")
        (println "ğŸ¬ Validating grain file...")
        (println (format "   File: ~a" filepath))
        
        ;; Read file
        (let ((content (slurp filepath)))
          ;; Validate
          (let ((result (validate-graincard content)))
            ;; Pretty print result
            (print-validation-result result)
            
            ;; Return exit code
            (if (:valid result) 0 1))))))

;; â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
;; â•‘ SCRIPT EXECUTION                                                             â•‘
;; â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

;; Run main if executed as script
(when (defined? '*args*)
  (exit (main *args*)))

;; â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
;; â•‘ REPL EXAMPLES (for interactive testing)                                     â•‘
;; â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

(comment
  ;; Test with a grain file
  (let ((content (slurp "xbdghj-grainbranch-readme-sync-babashka.md")))
    (let ((result (validate-graincard content)))
      (print-validation-result result)))
  
  ;; Check specific specs
  (spec-grain-code-with-next-button? (string-split (slurp "xbdghj-*.md") "\n"))
  
  ;; Extract grain code
  (extract-grain-code (string-split (slurp "xbdghj-*.md") "\n"))
  )

;; â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
;; â•‘ Glow G2's Note: This validator is itself a teaching tool. Read the code     â•‘
;; â•‘ comments. They explain WHY each rule exists, not just WHAT it checks.       â•‘
;; â•‘ That's the Glow G2 way - patient explanation, asking questions, showing     â•‘
;; â•‘ you how to think about the problem. Does this make sense? ğŸŒ¾                â•‘
;; â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

;; â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
;; â•‘ Grainbook Issue 1: Ember Harvest ğŸƒ (System Magazine)                       â”‚
;; â•‘ Grain: graincard-spec validator (Ketos implementation)                      â”‚
;; â•‘ Team: 06 (teamprecision06 - The Lovers) + 14 (teamdescend14 - Death)        â”‚
;; â•‘ now == next + 1 ğŸŒ¾                                                           â”‚
;; â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
